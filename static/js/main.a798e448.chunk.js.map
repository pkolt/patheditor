{"version":3,"sources":["components/PointSearch.js","components/PointListItem.js","components/PointList.js","components/Map.js","util.js","App.js","index.js"],"names":["PointSearch","props","value","onChange","onSubmit","e","preventDefault","className","type","placeholder","target","defaultProps","React","memo","title","onRemove","onClick","PointList","items","map","item","key","id","Map","onChangePoint","mState","center","point","zoom","controls","plGeometry","query","ns","load","state","width","height","defaultGeometry","options","draggable","properties","balloonContentHeader","onDragEnd","event","get","geometry","getCoordinates","balloonCloseButton","strokeColor","strokeWidth","searchPoint","a","async","fetch","response","json","data","geoObjects","GeoObjectCollection","featureMember","points","obj","GeoObject","Point","pos","split","parseFloat","reverse","console","error","App","useState","localStorage","getItem","JSON","parse","setItems","setValue","useEffect","setItem","stringify","setItemsLocalStorage","useCallback","filter","prevItems","uuid","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.a798e448.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst PointSearch = (props) => {\n    const {value, onChange, onSubmit} = props;\n    return <form onSubmit={(e) => {\n                    e.preventDefault();\n                    onSubmit();\n                }}>\n               <input className=\"form-control\" \n                      type=\"text\" \n                      placeholder=\"Введите новую точку маршрута и нажмите Enter\" \n                      value={value}\n                      onChange={(e) => onChange(e.target.value)}/>\n           </form>;\n}\nPointSearch.propTypes = {\n    value: PropTypes.string,\n    onChange: PropTypes.func,\n    onSubmit: PropTypes.func,\n};\n\nPointSearch.defaultProps = {\n    value: '',\n    onChange: () => {},\n    onSubmit: () => {}\n};\n\nexport default React.memo(PointSearch);","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst PointListItem = (props) => {\n    const {title, onRemove} = props;\n    return <li className=\"list-group-item\">\n                <div className=\"d-flex w-100 justify-content-between\">\n                    <span>{title}</span>\n                    <button type=\"button\" className=\"btn btn-outline-danger btn-sm\" onClick={onRemove}>Удалить</button>\n                </div>\n            </li>;\n}\n\nPointListItem.propTypes = {\n    title: PropTypes.string.isRequired,\n    onRemove: PropTypes.func.isRequired\n};\n\nexport default React.memo(PointListItem);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport PointListItem from './PointListItem';\n\nconst PointList = (props) => {\n    const {items, onRemove} = props;\n    return <ul className=\"list-group mt-2\">\n        {items.map(\n            (item) => <PointListItem key={item.id} \n                                     title={item.title}\n                                     onRemove={() => onRemove(item.id)}/>\n        )}\n    </ul>;\n}\n\nPointList.propTypes = {\n    items: PropTypes.array,\n    onRemove: PropTypes.func\n};\n\nPointList.defaultProps = {\n    items: [],\n    onRemove: () => {}\n};\n\nexport default React.memo(PointList);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {YMaps, Map as YMap, Placemark, Polyline} from 'react-yandex-maps';\n\nconst Map = (props) => {\n    const {items, onChangePoint} = props;\n    const ymQuery = {\n        ns: 'use-load-option',\n        load: 'Map,Placemark,control.ZoomControl,geoObject.addon.balloon',\n    };\n    const moscowPoint = [55.75, 37.57];\n    const firstPoint = items[0] && items[0].point;\n    const mState = {\n        center: firstPoint || moscowPoint, \n        zoom: 10, \n        controls: ['zoomControl']\n    };\n    const plGeometry = items.map(item => item.point);\n\n    return <YMaps query={ymQuery}>\n                <YMap state={mState} width=\"\" height={600}>\n                    {items.map((item) => <Placemark\n                                            key={item.id}\n                                            defaultGeometry={item.point}\n                                            options={{draggable: true}}\n                                            properties={{balloonContentHeader: item.title}}\n                                            onDragEnd={(event) => {\n                                                const point = event.get('target').geometry.getCoordinates();\n                                                onChangePoint(item.id, point);\n                                            }}\n                                        />\n                    )}\n                    <Polyline\n                        geometry={plGeometry}\n                        options={{\n                            balloonCloseButton: false,\n                            strokeColor: '#ff0000',\n                            strokeWidth: 2\n                        }}\n                        />\n                </YMap>\n    </YMaps>;\n}\n\nMap.propTypes = {\n    items: PropTypes.array,\n    onChangePoint: PropTypes.func\n};\n\nMap.defaultProps = {\n    items: [],\n    onChangePoint: () => {}\n};\n\nexport default React.memo(Map);","const apikey = 'b5ca0b9b-9f4b-4cbf-bcbf-f562a8297253';\n\nexport const searchPoint = async (value) => {\n    try {\n        const response = await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${apikey}&results=1&format=json&geocode=${value}`);\n        const data = await response.json();\n        const geoObjects = data.response.GeoObjectCollection.featureMember;\n        const points = geoObjects.map((obj) => {\n          const pos = obj.GeoObject.Point.pos;\n          const geometry = pos.split(' ').map(parseFloat).reverse();\n          return geometry;\n        });\n        return points[0];\n    } catch(error) {\n        console.error(error);\n    }\n}","import React, {useState, useCallback, useEffect} from 'react';\nimport uuid from 'uuid/v1';\nimport PointSearch from './components/PointSearch';\nimport PointList from './components/PointList';\nimport Map from './components/Map';\nimport {searchPoint} from './util';\n\nfunction App() {\n  const key = 'path-editor';\n  const getItemsLocalStorage = () => localStorage.getItem(key) && JSON.parse(localStorage.getItem(key));\n  const setItemsLocalStorage = (value) => localStorage.setItem(key, JSON.stringify(value));\n  const initialItems = () => getItemsLocalStorage() || [];\n  \n  const [items, setItems] = useState(initialItems);\n  const [value, setValue] = useState('');\n\n  useEffect(() => {\n    setItemsLocalStorage(items);\n  }, [items]);\n\n  const onRemove = useCallback((id) => {\n    setItems(items.filter((item) => item.id !== id));\n  }, [items]); \n\n  const onChange = useCallback(setValue, [value]);\n\n  const onSubmit = useCallback(async () => {\n    if (value) {\n      const point = await searchPoint(value);\n      if (point) {\n        setItems(prevItems => {\n          return [\n            {\n              id: uuid(),\n              title: value,\n              point\n            },\n            ...prevItems\n          ]\n        });\n        setValue('');\n      }\n    }\n  }, [value]);\n\n  const onChangePoint = useCallback((id, point) => {\n    setItems(prevItems => {\n      return prevItems.map(item => item.id === id ? {...item, point} : item);\n    })\n  }, []);\n\n  return <div className=\"container mt-5\">\n          <div className=\"row\">\n            <div className=\"col-sm\">\n              <PointSearch value={value} onChange={onChange} onSubmit={onSubmit}/>\n              <PointList items={items} onRemove={onRemove}/>\n            </div>\n            <div className=\"col-sm\">\n              <Map items={items} onChangePoint={onChangePoint}/>\n            </div>\n          </div>\n        </div>;\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'whatwg-fetch';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}